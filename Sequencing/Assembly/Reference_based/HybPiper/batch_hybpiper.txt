#!/bin/sh
#SBATCH --job-name=Hybpip_run1
#SBATCH --mail-type=ALL
#SBATCH --mail-user=jjantzen@ufl.edu 
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=10
#SBATCH --mem=70gb
#SBATCH --time=72:00:00
#SBATCH --output=logs/HybP_NR.%A.%a.out
#SBATCH --error=logs/HybP_NR.%A.%a.err




######SBATCH --array=0-144%10



echo -e "\nInfo: Starting a job on $(date) on $(hostname) in $(pwd).\n"

module load python exonerate bwa samtools spades velvet cap3 ncbi_blast parallel


#Run script from "HybPiper" folder
cd ../../../Cleaning/Data/Processed/cleaned_trimmed_reads/;

#DIRS=( $(ls -d */) )

#DIR="${DIRS[$SLURM_ARRAY_TASK_ID]}"
DIR="083_Sp3_2_clean"

R1FILE="$DIR"/*-READ1.fastq;
  
R2FILE="$DIR"/*-READ2.fastq;
 
R1Single="$DIR"/*-READ1-single.fastq;
  
R2Single="$DIR"/*-READ2-single.fastq;
  
#name=`basename ${R1FILE} _READ1.fastq`;
  
echo "Running HybPiper on ${SAMPLE}";
  
#forward="${SAMPLE}_READ1.fastq";
  
#reverse="${SAMPLE}_READ2.fastq";

##NOT WORKING
#DIR_short="${DIR::-1}";

echo -e "python /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/HybPiper_1.3.1/reads_first.py -r ${R1FILE} ${R2FILE} --unpaired ${R1Single} --unpaired ${R2Single} -b /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/Assembly/Reference_based/HybPiper/reduced_baits.fasta --cpu $SLURM_CPUS_ON_NODE --bwa --prefix /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/Assembly/Reference_based/HybPiper/${DIR}";

python /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/HybPiper_1.3.1/reads_first.py -r ${R1FILE} ${R2FILE} --unpaired ${R1Single} --unpaired ${R2Single} -b /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/Assembly/Reference_based/HybPiper/reduced_baits.fasta --cpu $SLURM_CPUS_ON_NODE --bwa --prefix /ufrc/soltis/jjantzen/Dissertation/Analysis/Sequencing/Assembly/Reference_based/HybPiper/${DIR};

echo -e "\nInfo: Job finished  on $(date)"
